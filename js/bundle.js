!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){(function(i){var n;
/*!
 *  howler.js v2.2.0
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),o=0;o<n.length;o++){var r=t._howls[i]._soundById(n[o]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),o=0;o<n.length;o++){var r=t._howls[i]._soundById(n[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),o=n&&parseInt(n[0].split("/")[1],10)<33;return e._codecs={mp3:!(o||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(i){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var s=e._howls[o]._getSoundIds(),r=0;r<s.length;r++){var a=e._howls[o]._soundById(s[r]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new o,r=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};r.prototype={init:function(e){var t=this;return s.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=null;if(s.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var i,n;if(this._format&&this._format[t])i=this._format[t];else{if("string"!=typeof(n=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(n))||(i=/\.([^.]+)$/.exec(n.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&s.codecs(i)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new a(this),this._webAudio&&u(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var o=0,r=0;r<i._sounds.length;r++)i._sounds[r]._paused&&!i._sounds[r]._ended&&(o++,n=i._sounds[r]._id);1===o?e=null:n=null}}var a=n?i._soundById(n):i._inactiveSound();if(!a)return null;if(n&&!e&&(e=a._sprite||"__default"),"loaded"!==i._state){a._sprite=e,a._ended=!1;var l=a._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(n&&!a._paused)return t||i._loadQueue("play"),a._id;i._webAudio&&s._autoResume();var u=Math.max(0,a._seek>0?a._seek:i._sprite[e][0]/1e3),c=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-u),h=1e3*c/Math.abs(a._rate),d=i._sprite[e][0]/1e3,p=(i._sprite[e][0]+i._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var f=function(){a._paused=!1,a._seek=u,a._start=d,a._stop=p,a._loop=!(!a._loop&&!i._sprite[e][2])};if(!(u>=p)){var m=a._node;if(i._webAudio){var _=function(){i._playLock=!1,f(),i._refreshBuffer(a);var e=a._muted||i._muted?0:a._volume;m.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):a._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),h!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h)),t||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?_():(i._playLock=!0,i.once("resume",_),i._clearTimer(a._id))}else{var v=function(){m.currentTime=u,m.muted=a._muted||i._muted||s._muted||m.muted,m.volume=a._volume*s.volume(),m.playbackRate=a._rate;try{var n=m.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,f(),n.then((function(){i._playLock=!1,m._unlocked=!0,t||(i._emit("play",a._id),i._loadQueue())})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(i._playLock=!1,f(),i._emit("play",a._id),i._loadQueue()),m.playbackRate=a._rate,m.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),h):(i._endTimers[a._id]=function(){i._ended(a),m.removeEventListener("ended",i._endTimers[a._id],!1)},m.addEventListener("ended",i._endTimers[a._id],!1))}catch(e){i._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=i._src,m.load());var g=window&&window.ejecta||!m.readyState&&s._navigator.isCocoonJS;if(m.readyState>=3||g)v();else{i._playLock=!0;var y=function(){v(),m.removeEventListener(s._canPlayEvent,y,!1)};m.addEventListener(s._canPlayEvent,y,!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var o=t._soundById(i[n]);if(o&&!o._paused&&(o._seek=t.seek(i[n]),o._rateSeek=0,o._paused=!0,t._stopFade(i[n]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),o=0;o<n.length;o++){i._clearTimer(n[o]);var s=i._soundById(n[o]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(n[o]),s._node&&(i._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&i._clearSound(s._node))),t||i._emit("stop",s._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(t),o=0;o<n.length;o++){var r=i._soundById(n[o]);r&&(r._muted=e,r._interval&&i._stopFade(r._id),i._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),i._emit("mute",r._id))}return i},volume:function(){var e,t,i,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&void 0===o[1]){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(i=t?n._soundById(t):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)(i=n._soundById(t[l]))&&(i._volume=e,o[2]||n._stopFade(t[l]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,s.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*s.volume()),n._emit("volume",i._id));return n},fade:function(e,t,i,n){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,i,n)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),o.volume(e,n);for(var r=o._getSoundIds(n),a=0;a<r.length;a++){var l=o._soundById(r[a]);if(l){if(n||o._stopFade(r[a]),o._webAudio&&!l._muted){var u=s.ctx.currentTime,c=u+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,c)}o._startFadeInterval(l,e,t,i,r[a],void 0===n)}}return o},_startFadeInterval:function(e,t,i,n,o,s){var r=this,a=t,l=i-t,u=Math.abs(l/.01),c=Math.max(4,u>0?n/u:n),h=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var o=(Date.now()-h)/n;h=Date.now(),a+=l*o,a=l<0?Math.max(i,a):Math.min(i,a),a=Math.round(100*a)/100,r._webAudio?e._volume=a:r.volume(a,e._id,!0),s&&(r._volume=a),(i<t&&a<=i||i>t&&a>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(i,e._id),r._emit("fade",e._id))}),c)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,i,n=this,o=arguments;if(0===o.length)return n._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(i=n._soundById(parseInt(o[0],10)))&&i._loop;e=o[0],n._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var s=n._getSoundIds(t),r=0;r<s.length;r++)(i=n._soundById(s[r]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var e,t,i,n=this,o=arguments;if(0===o.length)t=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(i=n._soundById(t))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var l=0;l<t.length;l++)if(i=n._soundById(t[l])){n.playing(t[l])&&(i._rateSeek=n.seek(t[l]),i._playStart=n._webAudio?s.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):i._node&&(i._node.playbackRate=e);var u=n.seek(t[l]),c=(n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-u,h=1e3*c/Math.abs(i._rate);!n._endTimers[t[l]]&&i._paused||(n._clearTimer(t[l]),n._endTimers[t[l]]=setTimeout(n._ended.bind(n,i),h)),n._emit("rate",i._id)}return n},seek:function(){var e,t,i=this,n=arguments;if(0===n.length)t=i._sounds[0]._id;else if(1===n.length){var o=i._getSoundIds(),r=o.indexOf(n[0]);r>=0?t=parseInt(n[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===t)return i;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var a=i._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var l=i.playing(t)?s.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+l*Math.abs(a._rate))}return a._node.currentTime}var c=i.playing(t);c&&i.pause(t,!0),a._seek=e,a._ended=!1,i._clearTimer(t),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var h=function(){i._emit("seek",t),c&&i.play(t,!0)};if(c&&!i._webAudio){var d=function(){i._playLock?setTimeout(d,0):h()};setTimeout(d,0)}else h()}return i},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this._duration,i=this._soundById(e);return i&&(t=this._sprite[i._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(s._canPlayEvent,t[i]._loadFn,!1),s._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var n=s._howls.indexOf(e);n>=0&&s._howls.splice(n,1);var o=!0;for(i=0;i<s._howls.length;i++)if(s._howls[i]._src===e._src||e._src.indexOf(s._howls[i]._src)>=0){o=!1;break}return l&&o&&delete l[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var o=this["_on"+e];return"function"==typeof t&&o.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this["_on"+e],o=0;if("number"==typeof t&&(i=t,t=null),t||i)for(o=0;o<n.length;o++){var s=i===n[o].id;if(t===n[o].fn&&s||!t&&s){n.splice(o,1);break}}else if(e)this["_on"+e]=[];else{var r=Object.keys(this);for(o=0;o<r.length;o++)0===r[o].indexOf("_on")&&Array.isArray(this[r[o]])&&(this[r[o]]=[])}return this},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this["_on"+e],o=n.length-1;o>=0;o--)n[o].id&&n[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(this,n[o].fn),0),n[o].once&&this.off(e,n[o].fn,n[o].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var i=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&i&&this.stop(e._id,!0).play(e._id),this._webAudio&&i){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var n=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),n)}return this._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),s._autoSuspend()),this._webAudio||i||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new a(this)},_drain:function(){var e=this._pool,t=0,i=0;if(!(this._sounds.length<e)){for(i=0;i<this._sounds.length;i++)this._sounds[i]._ended&&t++;for(i=this._sounds.length-1;i>=0;i--){if(t<=e)return;this._sounds[i]._ended&&(this._webAudio&&this._sounds[i]._node&&this._sounds[i]._node.disconnect(0),this._sounds.splice(i,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=s._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),this._node.gain.setValueAtTime(t,s.ctx.currentTime),this._node.paused=!0,this._node.connect(s.masterGain)):s.noAudio||(this._node=s._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(s._canPlayEvent,this._loadFn,!1),this._node.src=e._src,this._node.preload=!0===e._preload?"auto":e._preload,this._node.volume=t*s.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++s._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(s._canPlayEvent,this._loadFn,!1)}};var l={},u=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),o=0;o<i.length;++o)n[o]=i.charCodeAt(o);h(n.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?h(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},c(s)}},c=function(e){try{e.send()}catch(t){e.onerror()}},h=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(l[t._src]=e,d(t,e)):i()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(n).catch(i):s.ctx.decodeAudioData(e,n,i)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var n=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!n&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(n=function(){return{Howler:s,Howl:r}}.apply(t,[]))||(e.exports=n),t.Howler=s,t.Howl=r,void 0!==i?(i.HowlerGlobal=o,i.Howler=s,i.Howl=r,i.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=o,window.Howler=s,window.Howl=r,window.Sound=a)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.0
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,i){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,i="number"!=typeof i?this._pos[2]:i,"number"!=typeof e?this._pos:(this._pos=[e,t,i],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,i,n,o,s){if(!this.ctx||!this.ctx.listener)return this;var r=this._orientation;return t="number"!=typeof t?r[1]:t,i="number"!=typeof i?r[2]:i,n="number"!=typeof n?r[3]:n,o="number"!=typeof o?r[4]:o,s="number"!=typeof s?r[5]:s,"number"!=typeof e?r:(this._orientation=[e,t,i,n,o,s],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,i,n,o,s),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var s=n._getSoundIds(i),r=0;r<s.length;r++){var a=n._soundById(s[r]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,o),"spatial"===o?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,i,n,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,i,n,o)}}),s;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===o){if("number"!=typeof e)return s._pos;s._pos=[e,i,n]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var l=s._soundById(r[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,i,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,i,n)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(e,i,n,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,i,n,o)}}),s;if(i="number"!=typeof i?s._orientation[1]:i,n="number"!=typeof n?s._orientation[2]:n,void 0===o){if("number"!=typeof e)return s._orientation;s._orientation=[e,i,n]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var l=s._soundById(r[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,i,n],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,i,n)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var e,i,n,o=this,s=arguments;if(!o._webAudio)return o;if(0===s.length)return o._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(n=o._soundById(parseInt(s[0],10)))?n._pannerAttr:o._pannerAttr;e=s[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===s.length&&(e=s[0],i=parseInt(s[1],10));for(var r=o._getSoundIds(i),a=0;a<r.length;a++)if(n=o._soundById(r[a])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var u=n._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(n._pos||(n._pos=o._pos||[0,0,-.5]),t(n,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,i(1))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";i.r(t);var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.holder=document.querySelector("#holder"),this.play=document.querySelector("#play-button"),this.startText=document.querySelector("#game-info"),this.wrapper=document.querySelector("#canvas-wrapper"),this.canvas=document.querySelector("canvas"),this.footer=document.querySelector("footer"),this.gameOver=document.querySelector("#game-over-screen"),this.overTitle=document.querySelector("#game-over-title"),this.terminal=document.querySelector("#score-terminal"),this.scores=document.querySelector(".scores"),this.final=document.querySelector("#local-score"),this.local=document.querySelector("#local-top"),this.tutorialOpen=!0,this.tutorial=document.querySelector("#tutorial-window"),this.tutorialSlide=document.querySelector("#tutorial-slide"),this.tutorialText=document.querySelector("#tutorial-text"),this.tutorialP=document.querySelector("#tutorial-text-p"),this.tutorialIcon=document.querySelector("#tutorial-icon"),this.hotkeysOpen=!1,this.hotkeysSlide=document.querySelector("#hotkeys-slide"),this.hotkeysIcon=document.querySelector("#hotkeys-icon"),this.hotkeysText=document.querySelector("#hotkeys-text"),this.topBar=document.querySelector("#game-controls"),this.infoTiles=document.querySelectorAll("#info > .info-tile"),this.score=document.querySelector("#info-score"),this.currWave=document.querySelector("#info-wave"),this.lives=document.querySelector("#info-lives"),this.bank=document.querySelector("#info-bits"),this.audio=document.querySelector("#audio-button"),this.audioImg=document.querySelector("#audio-button-img"),this.autoBox=document.querySelector("#auto-container"),this.auto=document.querySelector("input[name=auto-wave]"),this.wave=document.querySelector("#wave-button"),this.waveText=document.querySelector("#wave-text"),this.progress=document.querySelector("#wave-progress"),this.bottomBar=document.querySelector("#content-box"),this.towerMenu=document.querySelector("#towers"),this.type=document.querySelector("#tower-type"),this.typeH=document.querySelector("#type-header"),this.typeP=document.querySelector("#type-p"),this.damage=document.querySelector("#tower-damage"),this.damageH=document.querySelector("#damage-header"),this.damageP=document.querySelector("#damage-p"),this.range=document.querySelector("#tower-range"),this.rangeH=document.querySelector("#range-header"),this.rangeP=document.querySelector("#range-p"),this.speed=document.querySelector("#tower-speed"),this.speedH=document.querySelector("#speed-header"),this.speedP=document.querySelector("#speed-p"),this.next=document.querySelector("#tower-next"),this.nextH=document.querySelector("#next-header"),this.nextP=document.querySelector("#next-p"),this.towerEdits=document.querySelectorAll("#edit-tower-buttons > .edit-button"),this.upgrade=document.querySelector("#upgrade-button"),this.sell=document.querySelector("#sell-button")};function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.border=new Image,this.wall=new Image,this.wallSelected=new Image,this.tower=new Image,this.attack=new Image,this.slime={},this.gork={},this.uwo={},this.play={plain:new Image,hover:new Image,pressed:new Image},this.addTileSources(),this.addCreepImages()}var t,i,n;return t=e,(i=[{key:"addTileSources",value:function(){this.border.src="/images/board/border.png",this.border.style.opacity=.4,this.wall.src="/images/board/wall.png",this.wallSelected.src="/images/board/wall-selected.png",this.tower.src="/images/towers/towers.png",this.attack.src="/images/towers/attacks.png",this.play.plain.src="/images/splash/play-button.png",this.play.hover.src="/images/splash/play-button-hover.png",this.play.pressed.src="/images/splash/play-button-pressed.png"}},{key:"addCreepImages",value:function(){for(var e=0;e<5;e++)this.slime[e]=new Image,this.slime[e].src="/images/creeps/slime/slime-".concat(e,".png"),this.gork[e]=new Image,this.gork[e].src="/images/creeps/gork/gork-".concat(e,".png"),this.uwo[e]=new Image,this.uwo[e].src="/images/creeps/uwo/uwo-".concat(e,".png")}}])&&o(t.prototype,i),n&&o(t,n),e}();function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.dom=i,this.sprites=n,this.handleTitleScreen()}var t,i,n;return t=e,(i=[{key:"handleTitleScreen",value:function(){var e=this;this.dom.upgrade.style.opacity=0,this.dom.sell.style.opacity=0;var t=new Image;t.src="/images/splash/tower-time-title.png",t.onload=function(){e.game.context.drawImage(t,e.dom.canvas.width/2-t.width/2,40),e.dom.holder.style.opacity=100},this.addPlayButton()}},{key:"addPlayButton",value:function(){this.dom.play.style.backgroundImage="url(".concat(this.sprites.play.plain.src,")"),this.addListener("mouseover","hover"),this.addListener("mouseout","plain"),this.addListener("mousedown","pressed"),this.addListener("mouseup","hover"),this.addListener("click","hover",!0)}},{key:"addListener",value:function(e,t,i){var n=this;this.dom.play.addEventListener(e,(function(e){e.target.style.backgroundImage="url(".concat(n.sprites.play[t].src,")"),i&&setTimeout(n.handleStart.bind(n),300)}))}},{key:"handleStart",value:function(){this.dom.play.style.display="none",this.dom.startText.style.display="none",this.dom.footer.style.opacity=0,this.game.gameStarted=!0,this.game.run(),this.dom.canvas.style.backgroundColor="rgb(186, 186, 186)",this.dom.towerMenu.classList.add("active"),this.dom.topBar.style.opacity=100,this.dom.bottomBar.style.opacity=100,this.dom.tutorial.style.opacity=100,this.game.animateBorder(),this.game.animateBlocks(),this.game.muted||this.game.sound.play()}}])&&r(t.prototype,i),n&&r(t,n),e}();function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=i}var t,i,n;return t=e,(i=[{key:"add",value:function(e){this.x+=e.x,this.y+=e.y}},{key:"sub",value:function(e){this.x-=e.x,this.y-=e.y}},{key:"normalize",value:function(t){var i=Math.sqrt(this.x*this.x+this.y*this.y);return(i>1||t)&&(this.x/=i,this.y/=i),new e(this.x,this.y)}},{key:"slow",value:function(){return this.x/=2,this.y/=2,new e(this.x,this.y)}},{key:"addGetNew",value:function(t,i){return new e(t.x+i.x,t.y+i.y)}},{key:"subGetNew",value:function(t,i){return new e(t.x-i.x,t.y-i.y)}},{key:"getDir",value:function(){return Math.atan2(this.y,this.x)}},{key:"getMag",value:function(){var e=this.x*this.x,t=this.y*this.y;return Math.sqrt.apply(e+t)}},{key:"setDir",value:function(e){var t=this.getMag();this.x=Math.cos(e)*t,this.y=Math.sin(e)*t}},{key:"setMag",value:function(e){var t=this.getDir();this.x=Math.cos(t)*e,this.y=Math.sin(t)*e}},{key:"dist",value:function(e){var t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)}},{key:"copy",value:function(){return new e(this.x,this.y)}}])&&l(t.prototype,i),n&&l(t,n),e}();function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(t,i,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.dom=i,this.tutorial=n,this.scores=null,this.mouseX,this.mouseY,this.handleCanvas(),this.handleButtonClicks(),this.handleKeyListeners(),this.handleTileListeners(o),this.towerInfo=null}var t,i,n;return t=e,(i=[{key:"handleCanvas",value:function(){this.dom.canvas.addEventListener("mousemove",this.handleCanvasMove.bind(this)),this.dom.canvas.addEventListener("mouseover",this.handleCanvasOver.bind(this)),this.dom.canvas.addEventListener("mouseout",this.handleCanvasOut.bind(this)),this.dom.canvas.addEventListener("click",this.handleCanvasClick.bind(this)),this.dom.canvas.addEventListener("dblclick",this.handleCanvasDblClick.bind(this))}},{key:"handleCanvasMove",value:function(e){this.mouseX=e.offsetX,this.mouseY=e.offsetY;var t=this.game.towers;if(!(t.length<1)){var i=t[t.length-1];i.placed||!0!==this.game.placingTower||(i.location.x=this.mouseX,i.location.y=this.mouseY)}}},{key:"handleCanvasOver",value:function(){this.game.towers.length<1||(this.game.towers[this.game.towers.length-1].visible=!0)}},{key:"handleCanvasOut",value:function(){this.game.placingTower&&(this.game.placingTower=!1,this.game.towers.splice(this.game.towers.length-1,1))}},{key:"handleCanvasClick",value:function(){var e=Math.floor(this.mouseX/this.game.cellSize),t=Math.floor(this.mouseY/this.game.cellSize),i=this.game.grid[e][t];if(this.game.resetSelects(),this.game.placingTower)this.game.checkTowerPlacement(i);else for(var n=0;n<this.game.towers.length;n++){var o=this.game.towers[n];o.location.x===i.center.x&&o.location.y===i.center.y?o.selected?o.deselect(!0):o.select():o.selected=!1}}},{key:"handleCanvasDblClick",value:function(){var e=Math.floor(this.mouseX/this.game.cellSize),t=Math.floor(this.mouseY/this.game.cellSize),i=this.game.grid[e][t];this.game.resetSelects();for(var n=0;n<this.game.towers.length;n++){var o=this.game.towers[n];if(o.location.x===i.center.x&&o.location.y===i.center.y)return void this.game.selectAllTowers(o.type,o.level)}}},{key:"handleButtonClicks",value:function(){var e=this;this.dom.audio.addEventListener("click",this.audioClick.bind(this)),this.dom.wave.addEventListener("click",this.waveClick.bind(this)),this.dom.upgrade.addEventListener("click",this.upgradeClick.bind(this)),this.dom.sell.addEventListener("click",this.sellClick.bind(this)),this.dom.auto.addEventListener("change",(function(t){return e.autoWaveToggle(t,e.game)}))}},{key:"audioClick",value:function(){this.game.muted?(this.game.muted=!1,this.game.sound.play(),this.dom.audio.classList.remove("audio-off"),this.dom.audio.classList.add("audio-on")):(this.game.muted=!0,this.game.sound.pause(),this.dom.audio.classList.remove("audio-on"),this.dom.audio.classList.add("audio-off"))}},{key:"autoWaveToggle",value:function(e,t){e.currentTarget.checked?t.autoWave=!0:t.autoWave=!1}},{key:"waveClick",value:function(){this.game.sendingWave||!this.game.gameStarted||this.game.gameOver||(this.game.wave+=1,this.game.sendingWave=!0,this.game.waveTimer=400,1===this.game.wave&&(this.dom.waveText.innerText="Next Wave",this.dom.towerMenu.classList.remove("active"),this.tutorial.showInfo("start")),this.dom.wave.classList.remove("clickable"),this.game.nextWave())}},{key:"upgradeClick",value:function(){var e=this;this.game.selectedTowers.forEach((function(t){t.canUpgrade&&(e.game.bits-t.upgrade>=0?(e.game.bits-=t.upgrade,e.game.cr-=t.upgrade,t.handleUpgrade()):e.game.actions.blinkBank())}))}},{key:"sellClick",value:function(){var e=this;this.game.selectedTowers.forEach((function(t){t.deselect(!1),e.game.bits+=t.upgrade/2,e.game.cr+=t.upgrade/2})),this.game.resetSelects(),this.game.loadPaths();for(var t=0;t<this.game.numCols;t++)for(var i=0;i<this.game.numRows;i++)this.game.grid[t][i].loadAdjacentCells();this.game.path=this.game.getPath()}},{key:"handleKeyListeners",value:function(){var e=this;document.addEventListener("keydown",(function(t){27===t.keyCode?(e.game.placingTower=!1,e.game.selectedTowers.length&&e.game.resetSelects(),e.game.towers.length&&!e.game.towers[e.game.towers.length-1].placed&&e.game.towers.splice(e.game.towers.length-1,1)):49===t.keyCode?e.towerKey(0):50===t.keyCode?e.towerKey(1):51===t.keyCode?e.towerKey(2):52===t.keyCode?e.towerKey(3):83===t.keyCode?e.sellClick():81===t.keyCode?e.upgradeClick():73===t.keyCode?e.tutorial.toggleTutorial():72===t.keyCode&&e.tutorial.toggleHotkeys()}))}},{key:"towerKey",value:function(e){this.game.placingTower=!1;var t=this.game.towers;t.length&&!t[t.length-1].placed&&t.pop(),this.game.tileDivs[e].click();var i=t[t.length-1];i.placed||(i.location=new u(this.mouseX,this.mouseY)),i.visible=!0}},{key:"handleTileListeners",value:function(e){for(var t=this,i=0;i<e.length;i++){var n=e[i];n.addEventListener("mouseover",(function(e){return t.tileRollOver(e,t.game)}),!1),n.addEventListener("mouseout",(function(e){return t.tileRollOut(e,t.game)}),!1),n.addEventListener("click",(function(e){return t.tileClicked(e,t.game)}),!1)}}},{key:"tileRollOver",value:function(e,t){t.showTowerDivInfo=e.currentTarget}},{key:"tileRollOut",value:function(e,t){t.showTowerDivInfo=null}},{key:"tileClicked",value:function(e,t){var i=e.currentTarget;!0===t.placingTower&&(t.towers[t.towers.length-1].placed||t.towers.splice(t.towers.length-1,1)),t.bits>=i.cost?(t.createTower(i),t.currentTileDiv=i,t.placingTower=!0,t.selectedTowers&&t.resetSelects()):t.actions.blinkBank()}},{key:"blinkBank",value:function(){var e=this.dom.bank;e.classList.contains("flashing")||(e.classList.add("flashing"),setTimeout((function(){e.classList.remove("flashing")}),1e3))}},{key:"showTowerInfo",value:function(){var e=this.getTower();this.toggleEditButtons(e),e&&e!==this.tower&&(this.tower=e,this.dom.typeP.innerHTML=e.type.toUpperCase(),this.dom.damageP.innerHTML=e.damage,this.dom.rangeP.innerHTML=e.range,this.dom.speedP.innerHTML=2e3-e.cooldown,e.canUpgrade||this.game.showTowerDivInfo?this.dom.nextP.innerHTML=e.upgrade+"":this.dom.nextP.innerHTML="Max")}},{key:"getTower",value:function(){return this.game.showTowerDivInfo?this.game.showTowerDivInfo:this.game.selectedTowers[this.game.selectedTowers.length-1]}},{key:"toggleEditButtons",value:function(e){var t=this.dom.upgrade.style.opacity,i=this.dom.sell.style.opacity;e?(this.dom.upgrade.style.opacity=e.canUpgrade?100:0,this.dom.sell.style.opacity=e.placed?100:0):(this.dom.upgrade.style.opacity=0,this.dom.sell.style.opacity=0),t!==this.dom.upgrade.style.opacity&&this.dom.upgrade.classList.toggle("clickable"),i!==this.dom.sell.style.opacity&&this.dom.sell.classList.toggle("clickable")}},{key:"updateStats",value:function(){for(var e=0;e<this.dom.infoTiles.length;e++){var t=this.dom.infoTiles[e],i=document.createElement("p");t.innerHTML.includes("Bank")?(t.innerHTML="<h4>Bank</h4> <br/>",i.innerHTML=this.game.bits+""):t.innerHTML.includes("Lives")?(t.innerHTML="<h4>Lives</h4> <br/>",i.innerHTML=this.game.lives):t.innerHTML.includes("Score")?(t.innerHTML="<h4>Score</h4> <br/>",i.innerHTML=this.game.score):t.innerHTML.includes("Wave")&&(t.innerHTML="<h4>Wave</h4> <br/>",i.innerHTML=this.game.wave),t.appendChild(i)}}},{key:"handleGameOver",value:function(){var e=this;this.game.sound.stop(),this.game.gameOver=!0,this.game.context.fillStyle="rgba(125, 125, 125, 0.6)",this.game.context.fillRect(0,0,840,560),this.dom.gameOver.style.opacity=100,this.dom.gameOver.style.width="100%",this.dom.gameOver.style.height="100%",this.dom.overTitle.style.display="inline-block";var t=firebase.database().ref("scores").orderByChild("score").limitToLast(10);this.game.f=this.game.score;var i=window.localStorage.getItem("score");(i&&i<this.game.f||!i)&&(i=this.game.f,window.localStorage.setItem("score",this.game.f)),this.dom.final.innerHTML="Final Score: ".concat(this.game.f),this.dom.local.innerHTML="Local Highest: ".concat(i),setTimeout((function(){e.dom.holder.style.opacity=0,e.dom.gameOver.style.top="15%",e.dom.overTitle.style.color="rgb(171, 171, 171)",e.dom.terminal.style.display="flex",e.dom.canvas.style.backgroundColor="",e.dom.tutorial.style.opacity=0,e.dom.topBar.style.opacity=0,e.dom.bottomBar.style.opacity=0,setTimeout((function(){e.dom.terminal.style.opacity=100,e.scores.handleScores(t),setTimeout((function(){e.game.context.clearRect(0,0,840,560)}),1e3)}),1e3)}),1e3)}},{key:"newGame",value:function(){for(this.dom.gameOver.style.opacity=0,this.dom.gameOver.style.width="0px",this.dom.gameOver.style.height="0px",this.dom.overTitle.style.display="none",this.dom.terminal.style.display="none",this.dom.holder.style.opacity=100,this.dom.footer.style.opacity=100,this.dom.gameOver.style.top="40%",this.dom.progress.style.width="0%",this.dom.terminal.removeChild(this.dom.terminal.lastChild);this.dom.scores.firstChild;)this.dom.scores.removeChild(this.dom.scores.lastChild);for(;this.dom.towerMenu.firstChild;)this.dom.towerMenu.removeChild(this.dom.towerMenu.lastChild);this.dom.auto.checked=!1,this.dom.waveText.innerText="First Wave",this.dom.wave.classList.remove("active"),this.dom.topBar.style.opacity=0,this.dom.bottomBar.style.opacity=0,this.dom.play.style.display="",this.dom.startText.style.display="flex",this.dom.tutorialOpen&&this.tutorial.toggleTutorial(),this.dom.hotkeysOpen&&this.tutorial.toggleHotkeys(),this.init()}}])&&c(t.prototype,i),n&&c(t,n),e}();function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.dom=i,this.slide1=this.dom.tutorialSlide,this.slide2=this.dom.hotkeysSlide,this.slide1.addEventListener("click",this.toggleTutorial.bind(this)),this.slide2.addEventListener("click",this.toggleHotkeys.bind(this)),this.default="move your mouse anywhere to learn more, click here to hide tooltips",this.tips=this.makeTips(),this.addListeners(this.tips)}var t,i,n;return t=e,(i=[{key:"addListeners",value:function(e){var t=this,i=function(i){var n=e[i],o=t.dom[i];o.addEventListener("mouseover",(function(){return t.showInfo(i,n)})),o.addEventListener("mouseout",t.clearTip.bind(t))};for(var n in e)i(n)}},{key:"toggleTutorial",value:function(){this.dom.tutorialText.classList.toggle("hidden"),this.dom.tutorialOpen=!this.dom.tutorialOpen,this.dom.tutorialSlide.setAttribute("class",this.dom.tutorialOpen?"open":"closed"),this.dom.tutorialIcon.classList.toggle("hidden")}},{key:"toggleHotkeys",value:function(){this.dom.hotkeysText.classList.toggle("hidden"),this.dom.hotkeysOpen=!this.dom.hotkeysOpen,this.dom.hotkeysSlide.setAttribute("class",this.dom.hotkeysOpen?"open":"closed"),this.dom.hotkeysIcon.classList.toggle("hidden")}},{key:"showInfo",value:function(e,t){if(0===this.game.wave&&("canvas"===e&&(t=this.game.bits<50?"now that you have a few towers, you're ready to take on the first wave! good luck":"enemies will start at the blue square and try to get to the red one, build towers to stop them"),"towerMenu"===e&&(t="click a tower to select it, then click on the board to buy and place it")),"type"===e){var i=this.dom.type.lastChild.innerHTML;"EARTH"===i?t="earth type is a basic tower, good for using up spare bank and making long walls; packs a punch once upgraded":"WATER"===i?t="water type slows things down a little, but is also a little slow; make sure it can hit its target, or at least something...":"FIRE"===i?t="fire type is fast, but has a low range; it needs to be in the heat of battle to be fully effective":"AIR"===i&&(t="air type is a lofty tower, and attacks everything in its path; give it good direction and it'll blow enemies away")}else"upgrade"!==e&&"sell"!==e||this.game.selectedTowers.length||(t=this.default);this.dom.tutorialP.innerHTML=t,this.ensureDefault()}},{key:"ensureDefault",value:function(){"undefined"===this.dom.tutorialP.innerHTML&&(this.dom.tutorialP.innerHTML=this.default)}},{key:"clearTip",value:function(){this.dom.tutorialP.innerHTML=this.default}},{key:"makeTips",value:function(){return{canvas:"enemies will start at the blue square and try to get to the red one, but cannot move through blocks or towers; click on placed towers to edit them",score:"your score increases for every enemy stopped before it reaches the red square",currWave:"the amount of waves you have survived so far, including the current wave",lives:"if an enemy makes it to the red square, you lose a life; reach zero lives and the this.game is over",bank:"spend your bank on towers and upgrades; add to it by stopping enemies and sending waves",autoBox:"select to send the next wave once there are no more enemies on the board",wave:"send the next wave of enemies",towerMenu:"hover over a tower to show its stats, click one to select it, then click on the board to buy a new tower of that type",type:"the tower's type; look at individual tower notes while a tower is selected",damage:"amount of damage each of the tower's attacks will deal to an enemy",range:"the tower's line of sight",speed:"how quickly the tower fires",next:"cost to upgrade the tower",upgrade:"upgrade the current tower for its next cost",sell:"sell the current tower for its most recent cost"}}}])&&d(t.prototype,i),n&&d(t,n),e}();function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t,i,n,o,s,r,a,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.grid=i,this.size=n,this.location=new u(a*this.size,l*this.size),this.center=new u(this.location.x+this.size/2,this.location.y+this.size/2),this.context=o,this.col=a,this.row=l,this.wallImg=s,this.selectImg=r,this.img=this.wallImg,this.adjacent=[],this.smallestAdjacent=null,this.value=-1,this.static=!1,this.occupied=!1,this.attacked=!1,this.selected=!1,this.attackDamage=null,this.attackSlow=!1,this.attackTimeout=0,this.cancelled=!1,this.cancTimeout=0}var t,i,n;return t=e,(i=[{key:"loadAdjacentCells",value:function(){this.row>0&&!this.occupied&&!this.grid[this.col][this.row-1].occupied&&this.adjacent.push(this.grid[this.col][this.row-1]),this.col<this.grid.length-1&&!this.occupied&&!this.grid[this.col+1][this.row].occupied&&this.adjacent.push(this.grid[this.col+1][this.row]),this.row<this.grid[this.col].length-1&&!this.occupied&&!this.grid[this.col][this.row+1].occupied&&this.adjacent.push(this.grid[this.col][this.row+1]),this.col>0&&!this.occupied&&!this.grid[this.col-1][this.row].occupied&&this.adjacent.push(this.grid[this.col-1][this.row])}},{key:"getShortestRoute",value:function(){for(var e,t,i=0;i<this.adjacent.length;i++)(this.adjacent[i].value<e||void 0===e)&&(e=this.adjacent[i].value,t=i);this.smallestAdjacent=this.adjacent[t]}},{key:"attack",value:function(e,t){this.attacked=!0,this.attackDamage=e,this.attackSlow=t,this.attackTimeout=2+t}},{key:"cancel",value:function(){this.occupied=!1,this.cancelled=!0,this.cancTimeout=3}},{key:"timeout",value:function(){this.cancTimeout--,this.cancTimeout<=0&&(this.cancelled=!1)}},{key:"run",value:function(){this.checkAttack(),this.render()}},{key:"checkAttack",value:function(){this.attacked&&(this.attackTimeout--,this.attackTimeout<=0&&(this.attacked=!1))}},{key:"render",value:function(){this.static||this.occupied?this.renderImage("img"):this.cancelled&&(this.context.fillStyle="rgba(255, 255, 255, 0.6)",this.timeout(),this.context.fillRect(this.location.x,this.location.y,this.size,this.size))}},{key:"renderImage",value:function(e){this.context.save(),this.context.translate(this.center.x,this.center.y),this.context.drawImage(this[e],-this[e].width/2,-this[e].height/2),this.context.restore()}}])&&f(t.prototype,i),n&&f(t,n),e}();function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=function(){function e(t,i,n,o,s,r,a,l,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.location=t.copy(),this.sprites=i,this.context=n,this.angle=o,this.radius=10,this.idx=s,this.level=r,this.type=a,this.speed=5,this.hit=!1,this.damage=l,this.speed=u,this.width=18,this.height=18}var t,i,n;return t=e,(i=[{key:"run",value:function(){this.update(),this.render()}},{key:"update",value:function(){this.location.y+=Math.sin(this.angle)*this.speed,this.location.x+=Math.cos(this.angle)*this.speed,(this.location.x>840||this.location.x<0||this.location.y>560||this.location.y<0)&&(this.hit=!0)}},{key:"render",value:function(){this.context.save(),this.context.translate(this.location.x,this.location.y),this.context.rotate(this.angle),this.context.drawImage(this.sprites.attack,this.level*this.width,this.idx*this.height,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height),this.context.restore()}}])&&_(t.prototype,i),n&&_(t,n),e}();function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,i,n,o,s,r,a,l,c,h,d,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.dom=i,this.sprites=n,this.width=32,this.height=32,this.idx=s,this.cost=r,this.upgrade=a,this.type=l,this.range=c,this.cooldown=d,this.damage=h,this.speed=p,this.cell=null,this.location=new u(0,0),this.lastFired=Date.now(),this.context=o,this.angle=0,this.target=null,this.follow=!0,this.selected=!1,this.level=0,this.canUpgrade=!0,this.visible=!1,this.placed=!1,this.removed=!1}var t,i,n;return t=e,(i=[{key:"findTarget",value:function(){for(var e=0;e<this.game.creeps.length;e++){var t=this.game.creeps[e];if(t.alive&&t.location.dist(this.location)<this.range)return this.follow=!1,t.location}return this.follow=!0,new u(this.game.actions.mouseX,this.game.actions.mouseY)}},{key:"checkFire",value:function(){var e=Date.now();if(this.location.dist(this.target)<this.range&&this.placed&&!this.follow&&e-this.lastFired>this.cooldown){this.lastFired=e;var t=new u(this.location.x,this.location.y),i=new v(t,this.sprites,this.context,this.angle,this.idx,this.level,this.type,this.damage,this.speed);this.game.attacks.push(i)}}},{key:"handleUpgrade",value:function(){this.level+=1,this.upgrade*=2,this.damage=5*Math.ceil(2.5*this.damage/5),this.range+=25,this.speed+=2,2===this.level&&(this.canUpgrade=!1)}},{key:"select",value:function(){this.selected=!0,this.cell.selected=!0,this.game.selectedTowers.push(this),this.game.selectedCells.push(this.cell)}},{key:"deselect",value:function(e){this.selected=!1,this.cell.selected=!1,e||(this.removed=!0,this.cell.occupied=!1)}},{key:"drawRange",value:function(){this.context.save(),this.context.beginPath(),this.context.arc(this.location.x,this.location.y,this.range,0,2*Math.PI),this.context.strokeStyle="rgba(222, 255, 252, 0.4)",this.context.lineWidth=4,this.context.stroke(),this.context.restore()}},{key:"run",value:function(){this.update(),this.render()}},{key:"update",value:function(){this.target=this.findTarget();var e=this.location.x-this.target.x,t=this.location.y-this.target.y;this.angle=Math.atan2(t,e)-Math.PI,this.checkFire()}},{key:"render",value:function(){this.visible&&(this.placed||this.drawRange(),this.context.save(),this.context.translate(this.location.x,this.location.y),this.context.rotate(this.angle),this.context.drawImage(this.sprites.tower,this.level*this.width,this.idx*this.height,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height),this.context.restore())}}])&&g(t.prototype,i),n&&g(t,n),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=A(e);if(t){var o=A(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return T(this,i)}}function T(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var I=function(){function e(t,i,n,o){S(this,e),this.game=t,this.sprites=i,this.difficulty=o,this.worth=5*this.difficulty,this.pointValue=100*this.difficulty,this.alive=!0,this.w=this.maxHealth,this.location=n,this.prevCell=null,this.currentCell=this.getCell(),this.nextCell=null,this.stuck=!1,this.velocity=new u(0,0),this.acceleration=new u(0,0),this.context=this.game.context,this.radius=12,this.color="rgb(225, 225, 225)",this.currSheet=0,this.dir=0,this.frame=0,this.step=0,this.slowed=!1,this.slowTimeout=0}var t,i,n;return t=e,(i=[{key:"checkBorder",value:function(){(this.location.x<=45||this.location.x>795)&&(this.velocity.x=-this.velocity.x/2),(this.location.y<=45||this.location.y>515)&&(this.velocity.y=-this.velocity.y/2)}},{key:"checkWalls",value:function(){this.getCell().occupied&&!this.stuck&&this.prevCell&&(this.velocity.x=-this.velocity.x/2,this.velocity.y=-this.velocity.y/2)}},{key:"checkHit",value:function(){this.currentCell.attacked&&(this.health-=this.currentCell.attackDamage,this.currentCell.attackSlow&&this.slow())}},{key:"checkAlive",value:function(){this.health<=0&&(this.game.bits+=this.worth,this.game.score+=this.pointValue,this.game.cr+=this.worth+this.pointValue,this.alive=!1)}},{key:"checkSheet",value:function(){this.slowed?this.currSheet=4:this.health<=.25*this.maxHealth?this.currSheet=3:this.health<=.5*this.maxHealth?this.currSheet=2:this.health<=.75*this.maxHealth?this.currSheet=1:this.currSheet=0}},{key:"takeLife",value:function(){if(this.alive=!1,!this.game.gameOver){this.game.lives-=1,this.game.cr-=1;var e=document.querySelector("#info-lives");e.classList.contains("flashing")||(e.classList.add("flashing"),setTimeout((function(){e.classList.remove("flashing")}),1e3))}}},{key:"slow",value:function(){this.slowed=!0,this.slowTimeout=30}},{key:"moveSlow",value:function(){this.velocity.slow(),this.slowTimeout--,this.slowTimeout<=0&&(this.slowed=!1)}},{key:"move",value:function(){this.acceleration=this.acceleration.subGetNew(this.nextCell.center,this.currentCell.center),this.acceleration.setMag(.05),this.setDir(this.nextCell.location),this.velocity.add(this.acceleration),this.velocity.normalize(this.slowed||this.stuck),this.slowed&&this.moveSlow(),this.location.add(this.velocity)}},{key:"getCell",value:function(){var e=Math.floor(this.location.x/this.game.cellSize),t=Math.floor(this.location.y/this.game.cellSize);return this.game.grid[e][t]}},{key:"setCells",value:function(){var e=this.getCell();e!==this.game.goal?(this.stuck=e.occupied,this.stuck?this.nextCell=this.prevCell:(this.prevCell=this.currentCell,this.nextCell=e.smallestAdjacent),this.currentCell=e):this.takeLife()}},{key:"setDir",value:function(e){var t=this.currentCell.location;e.x>t.x?this.dir=2:e.x<t.x?this.dir=1:e.y<t.y?this.dir=3:this.dir=0}},{key:"stepAnimation",value:function(){this.step++,(!this.slowed&&this.step>=10||this.step>=20)&&(this.step=0,this.frame=(this.frame+1)%4),this.drawFrame()}},{key:"drawFrame",value:function(){this.context.save(),this.context.translate(this.location.x,this.location.y),this.context.drawImage(this.sprites[this.type][this.currSheet],this.frame*this.size,this.dir*this.size,this.size,this.size,-this.size,-this.size-this.offset,2*this.size,2*this.size),this.context.restore()}},{key:"run",value:function(){this.update(),this.render()}},{key:"update",value:function(){this.checkWalls(),this.checkBorder(),this.checkHit(),this.checkAlive(),this.setCells(),this.move()}},{key:"render",value:function(){this.checkSheet(),this.stepAnimation()}}])&&C(t.prototype,i),n&&C(t,n),e}(),M=function(e){b(i,e);var t=x(i);function i(e,n,o,s){var r;return S(this,i),(r=t.call(this,e,n,o,s)).type="slime",r.maxHealth=350*e.wave*r.difficulty,r.health=r.maxHealth,r.size=16,r.offset=4,r}return i}(I),L=function(e){b(i,e);var t=x(i);function i(e,n,o,s){var r;return S(this,i),(r=t.call(this,e,n,o,s)).type="gork",r.maxHealth=800*e.wave*r.difficulty,r.health=r.maxHealth,r.size=18,r.offset=4,r}return i}(I),P=function(e){b(i,e);var t=x(i);function i(e,n,o,s){var r;return S(this,i),(r=t.call(this,e,n,o,s)).type="uwo",r.maxHealth=1200*e.wave*r.difficulty,r.health=r.maxHealth,r.size=32,r.offset=16,r}return i}(I);function O(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var H=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dom=t,this.sprites=i,this.canvas=this.dom.canvas,this.context=this.canvas.getContext("2d"),this.grid=[],this.towers=[],this.attacks=[],this.creeps=[],this.stages={},this.lives=20,this.bits=200,this.score=0,this.wave=0,this.difficulty=1,this.numBlocks=35,this.cellSize=40,this.numCols=21,this.numRows=14,this.start=null,this.goal=null,this.border=[],this.blocks=[],this.selectedCells=[],this.validated=!1,this.loadGrid(),this.loadPaths(),this.path=this.getPath(),this.vertices=this.getVertices(this.path),this.point=10,this.tileDivs=this.createTiles(),this.showTowerDivInfo=null,this.placingTower=!1,this.selectedTowers=[],this.autoWave=!1,this.sendingWave=!1,this.waveTimer=0,this.sound=n,this.muted=t.audio.classList.contains("audio-off"),this.gameStarted=!1,this.gameOver=!1,this.tutorial=new p(this,t),this.loader=new a(this,t,i),this.actions=new h(this,t,this.tutorial,this.tileDivs)}var t,i,n;return t=e,(i=[{key:"checkTowerPlacement",value:function(e){e.static||e.occupied||(e.occupied=!0,this.loadPaths(),this.checkPaths(e)&&this.checkRoute()?this.placeTower(e):(e.cancel(),this.loadPaths()))}},{key:"checkPaths",value:function(e){var t=this;return this.creeps.every((function(i){if(i.currentCell===e)return!1;for(var n=[i.currentCell];n.length;){var o=n.pop();if(o){if(-1===o.value)continue;if(o===t.goal)return!0;n.push(o.smallestAdjacent)}}return!1}))}},{key:"checkRoute",value:function(){for(var e=[this.start];e.length;){var t=e.pop();if(-1===t.value)return!1;if(t===this.goal)return!0;e.push(t.smallestAdjacent)}return!1}},{key:"resetSelects",value:function(){this.selectedTowers.forEach((function(e){e.deselect(!0)})),this.selectedTowers=[],this.selectedCells=[]}},{key:"selectAllTowers",value:function(e,t){this.resetSelects();for(var i=0;i<this.towers.length;i++){var n=this.towers[i];n.type===e&&n.level===t?n.select():n.deselect(!0)}}},{key:"createTiles",value:function(){for(var e=[],t=0;t<4;t++){var i=this.addTowerStats(t);this.dom.towerMenu.appendChild(i),e.push(i);var n=new Image;n.src="/images/towers/tiles/".concat(i.type,".png"),i.appendChild(n);var o=document.createElement("p");o.innerText="".concat(i.cost,""),i.appendChild(o)}return e}},{key:"addTowerStats",value:function(e){var t=document.createElement("div");return t.idx=e,0===e?(t.type="earth",t.cost=15,t.upgrade=30,t.range=100,t.cooldown=1e3,t.damage=30,t.speed=8):1===e?(t.type="water",t.cost=30,t.upgrade=60,t.range=120,t.cooldown=400,t.damage=10,t.speed=1):2===e?(t.type="fire",t.cost=50,t.upgrade=100,t.range=100,t.cooldown=200,t.damage=20,t.speed=10):(t.type="air",t.cost=100,t.upgrade=200,t.range=150,t.cooldown=1800,t.damage=100,t.speed=16),t}},{key:"createTower",value:function(e){var t=new y(this,this.dom,this.sprites,this.context,e.idx,e.cost,e.upgrade,e.type,e.range,e.damage,e.cooldown,e.speed);this.towers.push(t)}},{key:"placeTower",value:function(e){var t=this.towers[this.towers.length-1];t.cell=e,t.location=e.center.copy(),this.bits-=t.cost,t.placed=!0,this.placingTower=!1,this.path=this.getPath()}},{key:"loadGrid",value:function(){for(var e=0,t=0;t<this.numCols;t++){this.grid.push([]);for(var i=0;i<this.numRows;i++)this.grid[t].push(new m(e++,this.grid,this.cellSize,this.context,this.sprites.wall,this.sprites.wallSelected,t,i))}this.initBorder(),this.initPosts(),this.initBlocks()}},{key:"initBorder",value:function(){for(var e=0;e<this.numCols;e++)this.addBorderCell(e,0),this.addBorderCell(e,this.numRows-1);for(var t=0;t<this.numRows;t++)this.addBorderCell(0,t),this.addBorderCell(this.numCols-1,t)}},{key:"addBorderCell",value:function(e,t){var i=this.grid[e][t];i.occupied=!0,i.static=!0,i.img=this.sprites.border,this.border.push(i)}},{key:"initPosts",value:function(){this.start=this.grid[Math.ceil(3*Math.random())+1][Math.ceil(10*Math.random())+1];var e=new Image;e.src="/images/board/start.png",this.start.img=e,this.start.static=!0,this.goal=this.grid[Math.ceil(3*Math.random())+15][Math.ceil(10*Math.random())+1],this.goal.value=0;var t=new Image;t.src="/images/board/goal.png",this.goal.img=t,this.goal.static=!0}},{key:"initBlocks",value:function(){this.resetBlocks();for(var e=0;e<this.numBlocks;e++){var t=Math.floor(17*Math.random())+2,i=Math.floor(10*Math.random())+2,n=this.grid[t][i];n===this.start||n===this.goal||n.occupied?e--:(n.occupied=!0,this.blocks.push(n))}}},{key:"resetBlocks",value:function(){this.blocks.forEach((function(e){e.occupied=!1})),this.blocks=[]}},{key:"loadPaths",value:function(){this.resetPaths();for(var e=[this.goal];e.length;)for(var t=e.shift(),i=0;i<t.adjacent.length;i++){var n=t.adjacent[i];-1===n.value&&(e.push(n),n.value=t.value+1)}for(var o=0;o<this.grid.length;o++)for(var s=0;s<this.grid[o].length;s++)this.grid[o][s].occupied||this.grid[o][s].getShortestRoute();this.validated||this.ensureValidMap()}},{key:"resetPaths",value:function(){var e=this;this.grid.forEach((function(t){t.forEach((function(t){t!==e.goal&&(t.value=-1,t.adjacent=[])}))}));for(var t=0;t<this.numCols;t++)for(var i=0;i<this.numRows;i++)this.grid[t][i].loadAdjacentCells()}},{key:"ensureValidMap",value:function(){for(var e=!1,t=0;t<this.numCols;t++)for(var i=0;i<this.numRows;i++)-1!==this.grid[t][i].value||this.grid[t][i].occupied||(e=!0);e?(this.initBlocks(),this.loadPaths()):this.validated=!0}},{key:"nextWave",value:function(){this.bits=5*Math.ceil(this.bits/5),this.wave%10==0&&(this.difficulty+=.5),this.wave%30==0&&(this.difficulty+=.5),this.bits+=5*this.wave,this.loadCreeps(20)}},{key:"loadCreeps",value:function(e){for(var t=[],i=0;i<e;i++){var n=this.start.center.copy(),o=void 0;o=0===i?this.wave%5==0?new P(this,this.sprites,n,this.difficulty):new L(this,this.sprites,n,this.difficulty):new M(this,this.sprites,n,this.difficulty),t.push(o)}this.stages[this.wave]=[t,new Date-1500]}},{key:"sendCreeps",value:function(){for(var e in this.stages){var t=this.stages[e][0];if(t.length){var i=new Date;i-this.stages[e][1]>1500&&(this.creeps.push(t.shift()),this.stages[e][1]=i)}else delete this.stages[e]}}},{key:"checkHit",value:function(e){var t=Math.floor(e.location.x/this.cellSize),i=Math.floor(e.location.y/this.cellSize);if(this.grid[t]&&this.grid[t][i]){var n=this.grid[t][i];n.attack(e.damage,"water"===e.type);for(var o=0;o<this.creeps.length;o++)n===this.creeps[o].currentCell&&"air"!==e.type&&(e.hit=!0)}}},{key:"checkWave",value:function(){this.waveTimer>0?(this.waveTimer--,this.dom.progress.style.width="".concat(this.waveTimer/4,"%")):(this.sendingWave=!1,this.dom.wave.classList.add("clickable")),this.creeps.length?this.dom.wave.classList.remove("active"):this.sendingWave||(this.autoWave?this.dom.wave.click():this.wave>0?this.dom.wave.classList.add("active"):this.bits<50&&(this.dom.wave.classList.add("active"),this.dom.towerMenu.classList.remove("active"),this.tutorial.showInfo("canvas")))}},{key:"getPath",value:function(){for(var e=[this.start];e[e.length-1]!==this.goal;)e.push(e[e.length-1].smallestAdjacent);return this.vertices=this.getVertices(e),e}},{key:"getVertices",value:function(e){for(var t=[],i=1;i<e.length;i++)for(var n=e[i-1],o=e[i],s=o.center.x-n.center.x,r=o.center.y-n.center.y,a=0;a<15;a++){var l=n.center.x+s*a/15,u=n.center.y+r*a/15;t.push({x:l,y:u})}return t}},{key:"animatePath",value:function(){this.context.beginPath(),this.context.moveTo(this.start.center.x,this.start.center.y);for(var e=1;e<this.path.length;e++){var t=this.path[e];this.context.lineTo(t.center.x,t.center.y)}this.context.strokeStyle="rgba(164, 124, 194, 0.3)",this.context.lineWidth=4,this.context.stroke(),this.animateTravel(),this.point++}},{key:"animateTravel",value:function(){this.vertices.length<=this.point&&(this.point=10),this.context.beginPath(),this.context.arc(this.vertices[this.point-10].x,this.vertices[this.point-10].y,4,0,2*Math.PI),this.context.fillStyle="rgba(164, 124, 194, 0.3)",this.context.fill(),this.context.beginPath(),this.context.arc(this.vertices[this.point-5].x,this.vertices[this.point-5].y,5,0,2*Math.PI),this.context.fillStyle="rgba(164, 124, 194, 0.3)",this.context.fill(),this.context.beginPath(),this.context.arc(this.vertices[this.point].x,this.vertices[this.point].y,6,0,2*Math.PI),this.context.fillStyle="rgba(164, 124, 194, 0.3)",this.context.fill()}},{key:"animateBorder",value:function(){if(this.border.length){for(var e=0;e<this.border.length;e++){var t=this.border[e],i=this.border[this.border.length-1-e];this.blinkCell(t,e),this.blinkCell(i,e)}this.border=[]}}},{key:"animateBlocks",value:function(){if(this.blocks.length){for(var e=0;e<this.blocks.length;e++){var t=this.blocks[e];this.blinkCell(t,e+20)}this.blocks=[]}}},{key:"blinkCell",value:function(e,t){e.occupied=!1,e.static=!1,setTimeout((function(){e.occupied=!0,e.static=!0}),15*t)}},{key:"run",value:function(){this.actions.updateStats(),!this.gameOver&&this.gameStarted&&(this.actions.showTowerInfo(),this.checkWave(),this.sendCreeps(),this.render(),this.lives<=0&&setTimeout(this.actions.handleGameOver(),1e3))}},{key:"render",value:function(){this.context.clearRect(0,0,840,560),this.animatePath();for(var e=0;e<this.numCols;e++)this.grid[e][0].run(),this.grid[e][this.numRows-1].run();for(var t=1;t<this.numRows-1;t++)this.grid[0][t].run(),this.grid[this.numCols-1][t].run();for(var i=1;i<this.numCols-1;i++)for(var n=1;n<this.numRows-1;n++){var o=this.grid[i][n];o.selected||o.run()}for(var s=0;s<this.selectedCells.length;s++)this.selectedCells[s].renderImage("selectImg");for(var r=0;r<this.towers.length;r++){var a=this.towers[r];a.removed?(this.towers.splice(r,1),r--):a.run()}for(var l=0;l<this.creeps.length;l++){var u=this.creeps[l];u.alive?u.run():(this.creeps.splice(l,1),l--)}for(var c=0;c<this.selectedTowers.length;c++)this.selectedTowers[c].drawRange();for(var h=0;h<this.attacks.length;h++){var d=this.attacks[h];this.checkHit(d),d.hit?(this.attacks.splice(h,1),h--):d.run()}}}])&&O(t.prototype,i),n&&O(t,n),e}();function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var B=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dom=t,this.game=i,this.firebase=this.loadFireBase()}var t,i,n;return t=e,(i=[{key:"loadFireBase",value:function(){return firebase.initializeApp({apiKey:"AIzaSyCUl00bvLb_3Ytr6Wj_L-XIp-bVX4Yb8b0",authdomain:"tower-time.firebaseapp.com",databaseURL:"https://tower-time.firebaseio.com",projectId:"tower-time",storageBucket:"tower-time.appspot.com",messagingSenderId:"114254327718",appId:"1:114254327718:web:7d6db95c7f120f99452967",measurementId:"G-0BEHEHSDDL"})}},{key:"update",value:function(e,t){this.firebase.auth().signInAnonymously(),this.firebase.database().ref("scores").push({name:e,score:t})}},{key:"handleScores",value:function(e){var t,i=this,n=document.createElement("ul"),o=document.createElement("ul"),s=document.createElement("ul");e.on("value",(function(e){for(var r=e.val(),a=Object.keys(r),l=[],u=0;u<a.length;u++)l.push([r[a[u]].score,r[a[u]].name]);i.sortScores(l);var c=1;l.forEach((function(e){var t=document.createElement("li"),i=document.createElement("li"),r=document.createElement("li");t.innerText=c++,i.innerText=e[0],r.innerText=e[1],n.appendChild(t),o.appendChild(i),s.appendChild(r)})),t=l[9][0]}));var r=[n,o,s];if(["RANK","SCORE","NAME"].forEach((function(e,t){var n=document.createElement("div");n.classList.add("score-div");var o=document.createElement("h2");o.innerText=e,n.appendChild(o),n.appendChild(r[t]),i.dom.scores.appendChild(n)})),this.game.score>=t){var a=document.createElement("form"),l=document.createElement("input");l.classList.add("name-input"),l.placeholder="ADD NAME",l.maxLength=3,a.appendChild(l),this.dom.terminal.appendChild(a),a.addEventListener("submit",(function(e){return i.addScore(e,t,a)}))}else this.addNewGame()}},{key:"addScore",value:function(e,t,i){e.preventDefault();var n=document.querySelector(".name-input"),o=document.querySelectorAll(".score-div");this.game.score>=t&&o.forEach((function(e){e.querySelector("ul").innerHTML=""})),n.style.visibility="hidden",this.game.f===this.game.score?this.update(n.value.toUpperCase(),this.game.f):window.location.reload(!1),this.dom.terminal.removeChild(i),this.addNewGame()}},{key:"addNewGame",value:function(){var e=this,t=document.createElement("button");t.classList.add("new-game"),t.innerHTML="NEW GAME",t.addEventListener("click",(function(t){t.preventDefault(),e.game.actions.newGame()}),!1),this.dom.terminal.appendChild(t)}},{key:"sortScores",value:function(e){var t;do{t=!1;for(var i=0;i<e.length-1;i++)if(e[i][0]<e[i+1][0]){var n=e[i];e[i]=e[i+1],e[i+1]=n,t=!0}}while(t);return e}}])&&E(t.prototype,i),n&&E(t,n),e}(),q=i(0);window.addEventListener("load",(function e(){D=D||new n,F=new H(D,W,G),R?(R.game=F,R.dom=D):R=new B(D,F),F.actions.scores=R,F.actions.init=e,window.cancelAnimationFrame(j),window.setTimeout(V,100)}));var D,F,R,j,G=new q.Howl({src:"../audio/towertime.mp3",loop:!0}),W=new s;function V(){F.run(),j=window.requestAnimationFrame(V)}}]);